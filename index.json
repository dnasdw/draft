[{"categories":null,"content":"安装hugo-extended 官方教程 https://gohugo.io/getting-started/installing/ ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:1:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#安装hugo-extended"},{"categories":null,"content":"创建部署仓库draft https://github.com/new https://github.com/dnasdw/draft ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:2:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#创建部署仓库draft"},{"categories":null,"content":"创建源文件仓库pages_draft https://github.com/new https://github.com/dnasdw/pages_draft git clone --recursive https://github.com/dnasdw/pages_draft.git hugo new site pages_draft --force cd pages_draft 创建.gitignore # Generated files by hugo /public/ /resources/_gen/ /.hugo_build.lock # Executable may be added to repository hugo.exe hugo.darwin hugo.linux 添加主题 git submodule add https://github.com/dnasdw/DoIt.git themes/DoIt 修改config.toml baseURL = \"https://dnasdw.github.io/draft\" defaultContentLanguage = \"zh-cn\" theme = \"DoIt\" title = \"My New Hugo Site\" [languages] [languages.zh-cn] languageCode = \"zh-CN\" [params] version = \"0.2.X\" 提交推送 git add * git commit -m setup git push origin master ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:3:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#创建源文件仓库pages_draft"},{"categories":null,"content":"创建MY_GITHUB_TOKEN 查看是否已有token https://github.com/settings/tokens 如果没有则新建token https://github.com/settings/tokens/new Note: actions-gh-pages Expiration: No expiration Select scopes: [v] repo ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:4:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#创建my_github_token"},{"categories":null,"content":"设置MY_GITHUB_TOKEN 查看是否已设置token https://github.com/dnasdw/watcher_test/settings/secrets/actions 如果没有则设置token https://github.com/dnasdw/watcher_test/settings/secrets/actions/new MY_GITHUB_TOKEN: ghp_* ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:5:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#设置my_github_token"},{"categories":null,"content":"设置watcher git clone --recursive https://github.com/dnasdw/watcher_test.git cd watcher_test git submodule add https://github.com/dnasdw/pages_draft.git pages_draft 创建github actions配置.github/workflows/draft-gh-pages.yml name:GitHub Pageson:workflow_dispatch:inputs:commit_id:description:The branch, tag or SHA of the submodule to checkout.required:falsedefault:push:branches:- masterjobs:deploy:runs-on:ubuntu-20.04concurrency:group:${{ github.workflow }}-${{ github.ref }}steps:- uses:actions/checkout@v2with:token:${{ secrets.MY_GITHUB_TOKEN }}submodules:recursivefetch-depth:0- name:Checkout submodule with github tokenif:${{ github.event.inputs.commit_id != '' }}uses:actions/checkout@v2with:repository:dnasdw/pages_draftpath:pages_draftref:${{ github.event.inputs.commit_id }}token:${{ secrets.MY_GITHUB_TOKEN }}submodules:recursivefetch-depth:0- name:Get full commit message like peaceiris/actions-gh-pages@v3run:|pushd pages_draft printf -v FULL_COMMIT_MESSAGE %s \"$(git log -1 --pretty=format:%B) dnasdw/pages_draft@$(git log -1 --pretty=format:%H)\" echo \"$FULL_COMMIT_MESSAGE\" echo \"FULL_COMMIT_MESSAGE\u003c\u003cEOF\" \u003e\u003e $GITHUB_ENV echo \"$FULL_COMMIT_MESSAGE\" \u003e\u003e $GITHUB_ENV echo \"EOF\" \u003e\u003e $GITHUB_ENV popd- name:Disable quotePathrun:git config core.quotePath false- name:Setup Hugouses:peaceiris/actions-hugo@v2with:hugo-version:latestextended:true- name:Buildrun:|pushd pages_draft hugo --minify popd- name:Deployuses:peaceiris/actions-gh-pages@v3if:${{ github.ref == 'refs/heads/master' }}with:personal_token:${{ secrets.MY_GITHUB_TOKEN }}external_repository:dnasdw/draftpublish_branch:gh-pagespublish_dir:./pages_draft/publicforce_orphan:falseuser_name:Sun Daowenuser_email:sundaowen@gmail.comfull_commit_message:${{ env.FULL_COMMIT_MESSAGE }} 提交推送 git add * git commit -m \"setup draft\" git push origin master ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:6:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#设置watcher"},{"categories":null,"content":"设置worker 教程 https://github.com/dnasdw/workflow_dispatch-worker 参数例子 GITHUB_WEBHOOK_SECRET: 200 Payload URL: https://webhook_workflow_dispatch-worker.dnasdw.workers.dev/api/github/repos/dnasdw/watcher_test/actions/workflows/draft-gh-pages.yml/dispatches ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:7:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#设置worker"},{"categories":null,"content":"github pages地址 配置地址 https://github.com/dnasdw/draft/settings/pages 页面地址 https://dnasdw.github.io/draft/ ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:8:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#github-pages地址"},{"categories":null,"content":"更新config 参考配置 https://github.com/dnasdw/pages_draft/blob/master/config.toml ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:9:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#更新config"},{"categories":null,"content":"备注 如果config中baseURL包含子目录，则menu配置中的url不能以斜杠开始，比如“所有文章”的url不可以为/posts/，但可以为posts/或./posts/。 ","date":"2021-12-06","objectID":"/draft/posts/how-to-create-this-website/:10:0","series":null,"tags":null,"title":"如何创建这个网站","uri":"/draft/posts/how-to-create-this-website/#备注"}]